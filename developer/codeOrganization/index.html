<!doctype html>
<html class="no-js" lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Code Organization</title>

    <link rel="stylesheet" type="text/css" href="https://huss.github.io/OpenEnergyDashboard.github.io/assets/css/styles_feeling_responsive.css">

  

	<script src="https://huss.github.io/OpenEnergyDashboard.github.io/assets/js/modernizr.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
	<script>
		WebFont.load({
			google: {
				families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ]
			}
		});
	</script>

	<noscript>
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'>
	</noscript>


	<!-- Search Engine Optimization -->
	<meta name="description" content="Documentation overview

            









    

    

    
        
        Developer documentation
        








  Information
  
    
    
    
      
      
        Overview
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
  


        








  Starting
  
    
    
    
      
      
    
      
      
        Developer First Steps
      
    
      
      
        Steps for WSL
      
    
      
      
        Contributor License Agreement
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Creating Pull Requests
      
    
      
      
    
      
      
    
      
      
        Test Data
      
    
      
      
    
      
      
        Work Selection
      
    
  


        








  Codebase Info
  
    
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Learn OED Technology
      
    
      
      
    
      
      
        npm scripts
      
    
      
      
    
      
      
    
      
      
        Technology Overview
      
    
      
      
    
      
      
    
      
      
    
  


        








  Further Details
  
    
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Documentation Expectations
      
    
      
      
        Code Organization
      
    
      
      
        Developer Details
      
    
      
      
        Environment Variables
      
    
      
      
        Full Install Output
      
    
      
      
    
      
      
    
      
      
        No npm/DB Install Output
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Test Code
      
    
      
      
    
  


        








  Version Release
  
    
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Releasing OED
      
    
      
      
    
      
      
    
      
      
    
      
      
    
  


    

    

    


        
    


    
        


This information is for developers of the OED software so this information is not usually of interest to a general user.







The update to the Redux Toolkit (RTK) is not yet reflected in the documentation. As a result, some information may be out of date.





        The OED code base is organized into directories. Understanding the structure of this layout can help in
            working
            on the code.

        The project is organized into a number of subdirectories. The primary division is among:
        
            Metadata, configs, and deployment information
            Frontend code
            Backend code
            Common code
            Other directories
        

        Metadata
        In the root directory, OED has several metadata files. These are further organized by technology or purpose.
        
        For Humans
        
            CODE_OF_CONDUCT describes conduct expectations and how to report any concerns.
             CONTRIBUTING.md provides information on contributing to OED. 
             License.txt describes the legal aspect of the project. OED is licensed under the Mozilla Public License version 2.0.
            
             README.md is an overview of the project, displayed on the GitHub front page for the
                project. 
            Security.md describes how to report security concerns to OED.
            Support.md describes where to get information on support related to OED.
             USAGE.md describes how to install, configure, and use the project from a sysadmin&#39;s
                point
                of view. 
        
        For Development Tools
        
            .devcontainer/ has files to set up the Visual Studio Code container.
            .github/ ISSUE_TEMPLATE/ has GitHub issue template, workflows/ has two .yml files for
                GitHub Actions: one for CI and one for static and dependabot.yml controls GitHub automated pull
                requests.
            .vscode/ contains (currently nonworking) instructions to run OED within Visual Studio
                Code.
            
            .dockerignore defines files that Docker ignores.
             .editorconfig conveys some of our basic style rules to most common code editors. 
            .eslintignore defines files to include in ESLint checking.
            .eslintrc.json defines the ESLint rules
             .gitattributes informs Git about how to properly show diffs for our files. 
             .gitignore informs the Git Version Control System about files that it should not
                track.
            
            client.js does database setup for GitHub Action CI.
             tslint.json configures the TSLint code quality tool and style checker 
        
        For Code Transformers
        
             babel.config.json configures the Babel JavaScript compiler 
             webpack.config.js configures the WebPack JavaScript uglifier, optimizer, and packer
            
        
        For Dependency Management Tools
        
            .npmrc tells node package versions to allow on install
             docker-compose.yml specifies how to collect the database and web/vsc Docker containers
                together into a working deployment 
            the containers/ directory contains everything needed to build the Docker containers
                with
                subdirectories for the database and web (along with proxy if needed). 
             .dockerignore tells the Docker containerization engine which files to ignore 
             package.json specifies direct dependencies and some package metadata 
             package-lock.json specifies working direct and transitive dependencies used on the
                last
                build committed 
        

        Frontend Code
        All frontend code is stored in src/client/app/. This is the code that actually runs in the
            user&#39;s
            web browser. See the technologies page for a diagram showing how this code
            is
            transpiled and minified prior to delivery.
        This code is contained in several directories:
        
             actions/ are the messages that components send to reducers to change the application
                state. 
             components/ are the React.js components which generate HTML that is displayed on the
                page.
                Components can be combined and composed to create the UI that is displayed to the user. 
             containers/ connect the React.js components to the application state (managed by
                Redux)
                through props and dispatched actions. 
             reducers/ accept messages sent by components and change the global application state
                accordingly. 
             style/ CSS files for the website. 
             translations/ defines the strings used to make OED multilingual. 
             types/ define the datatypes used throughout the frontend. 
             utils/ defines functions used across the application and some APIs. 
        

        Backend Code
        All backend code is stored in src/server/, except for the executable server, which is
            src/bin/www/.
        
        Beneath that, there are several folders:
        
             data/ functions to generate test data (not used directly by the application but for
                testing). 
             middleware/ middleware for dealing with web requests. 
             migrations/ contains SQL files that are used to upgrade between database versions.
            
             models/ contains classes which connect JavaScript code to the database so that routes
                can
                actually interact with data. 
             routes/ contains functions defining the actual URLs that the server provides, which is
                how
                the frontend interacts with the server. 
             services/ contains scripts used by developers and administrators to modify the data in
                ways that are inaccessible through the web interface. 
             sql/ contains the database queries used by models to talk to the PostgreSQL database.
            
             test/ contains the test code run for validation of OED. 
             utils/ contains utility functions and constants. 
        

        Common Code
        All common code is stored in src/common/. This code defines data types which are in shared use
            between the client and the server.

        Scripts
        Scripts are stored in src/scripts/.
        The scripts are as follows:
        
             checkHeader.sh verifies that all source files have the MPLv2 legal header. It is run
                in
                CI. 
             checkMeters.sh verifies if a file of IP addresses has meters that respond. Used for
                testing meters or before input of meters into OED. Mostly targets MAMAC meters that are web based. 
             checkTypescript.sh verifies that there are no untyped JavaScript files in the client
                tree.
                It is run in CI. 
             devcheck.sh runs all the checks (header, typescript, types and lint) in one easy step.
            
             devstart.sh starts both the webserver and Webpack, in dev mode (watches files and
                shows
                interactive). This isn not normally used to start OED for developers. 
             installOED.sh sets up OED, either for development or production, creating the database
                schema and installing dependencies. This is often run using docker compose up or some
                variant
                of this. It should be automatically run inside toe VSC container. 
             oed.service is a sample systemd unit file which allows Linux system administrators to start OED on
                startup.
            
             refreshReadingViewsCron.bash is a script meant to be run at regular intervals (for
                instance, with cron) which updates the daily view table that is needed to graph OED data. 
             refreshDailyReadingViewsCron.bash is a script meant to be run at regular intervals
                (for
                instance, with cron) which updates the hourly view table that is needed to graph OED data. 
             sendLogEmailCron.bash is a script meant to be run at regular intervals (for instance,
                with
                cron) which sends an email with information from OED logging since the last time this ran. 
             updateEgaugeMetersOEDCron.bash is a script meant to be run at regular intervals (for
                instance, with cron) which updates eGauge-brand meters. 
             updateMamacMetersOEDCron.bash is a script meant to be run at regular intervals (for
                instance, with cron) which updates Mamac-brand pull-type meters. 
             updateOED.sh To be run after pulling the latest version from Git. Grabs new
                dependencies
                and migrates the database. 
        
        Other directories
        One will see other directories in the OED code base after install and work with OED. These are not normally
            changed by someone. A few noticeable ones are:
        
        
            node_modules/ is created during the npm install process and contains information on all
                node packages used.
            postgres-data/ is created during the PostgreSQL install process and contains the
                information about the database and all records stored. It is the one set of files that exist between
                runs of
                the Docker container and are linked from the Docker container to the regular file system. This is done
                so
                that the database settings and records exist between runs.">
	<meta name="google-site-verification" content="Vk0IOJ2jwG_qEoG7fuEXYqv0m2rLa8P778Fi_GrsgEQ">
	<meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" >
	
	
	
	<link rel="canonical" href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/codeOrganization/">


	<!-- Facebook Open Graph -->
	<meta property="og:title" content="Code Organization">
	<meta property="og:description" content="Documentation overview

            









    

    

    
        
        Developer documentation
        








  Information
  
    
    
    
      
      
        Overview
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
  


        








  Starting
  
    
    
    
      
      
    
      
      
        Developer First Steps
      
    
      
      
        Steps for WSL
      
    
      
      
        Contributor License Agreement
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Creating Pull Requests
      
    
      
      
    
      
      
    
      
      
        Test Data
      
    
      
      
    
      
      
        Work Selection
      
    
  


        








  Codebase Info
  
    
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Learn OED Technology
      
    
      
      
    
      
      
        npm scripts
      
    
      
      
    
      
      
    
      
      
        Technology Overview
      
    
      
      
    
      
      
    
      
      
    
  


        








  Further Details
  
    
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Documentation Expectations
      
    
      
      
        Code Organization
      
    
      
      
        Developer Details
      
    
      
      
        Environment Variables
      
    
      
      
        Full Install Output
      
    
      
      
    
      
      
    
      
      
        No npm/DB Install Output
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Test Code
      
    
      
      
    
  


        








  Version Release
  
    
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        Releasing OED
      
    
      
      
    
      
      
    
      
      
    
      
      
    
  


    

    

    


        
    


    
        


This information is for developers of the OED software so this information is not usually of interest to a general user.







The update to the Redux Toolkit (RTK) is not yet reflected in the documentation. As a result, some information may be out of date.





        The OED code base is organized into directories. Understanding the structure of this layout can help in
            working
            on the code.

        The project is organized into a number of subdirectories. The primary division is among:
        
            Metadata, configs, and deployment information
            Frontend code
            Backend code
            Common code
            Other directories
        

        Metadata
        In the root directory, OED has several metadata files. These are further organized by technology or purpose.
        
        For Humans
        
            CODE_OF_CONDUCT describes conduct expectations and how to report any concerns.
             CONTRIBUTING.md provides information on contributing to OED. 
             License.txt describes the legal aspect of the project. OED is licensed under the Mozilla Public License version 2.0.
            
             README.md is an overview of the project, displayed on the GitHub front page for the
                project. 
            Security.md describes how to report security concerns to OED.
            Support.md describes where to get information on support related to OED.
             USAGE.md describes how to install, configure, and use the project from a sysadmin&#39;s
                point
                of view. 
        
        For Development Tools
        
            .devcontainer/ has files to set up the Visual Studio Code container.
            .github/ ISSUE_TEMPLATE/ has GitHub issue template, workflows/ has two .yml files for
                GitHub Actions: one for CI and one for static and dependabot.yml controls GitHub automated pull
                requests.
            .vscode/ contains (currently nonworking) instructions to run OED within Visual Studio
                Code.
            
            .dockerignore defines files that Docker ignores.
             .editorconfig conveys some of our basic style rules to most common code editors. 
            .eslintignore defines files to include in ESLint checking.
            .eslintrc.json defines the ESLint rules
             .gitattributes informs Git about how to properly show diffs for our files. 
             .gitignore informs the Git Version Control System about files that it should not
                track.
            
            client.js does database setup for GitHub Action CI.
             tslint.json configures the TSLint code quality tool and style checker 
        
        For Code Transformers
        
             babel.config.json configures the Babel JavaScript compiler 
             webpack.config.js configures the WebPack JavaScript uglifier, optimizer, and packer
            
        
        For Dependency Management Tools
        
            .npmrc tells node package versions to allow on install
             docker-compose.yml specifies how to collect the database and web/vsc Docker containers
                together into a working deployment 
            the containers/ directory contains everything needed to build the Docker containers
                with
                subdirectories for the database and web (along with proxy if needed). 
             .dockerignore tells the Docker containerization engine which files to ignore 
             package.json specifies direct dependencies and some package metadata 
             package-lock.json specifies working direct and transitive dependencies used on the
                last
                build committed 
        

        Frontend Code
        All frontend code is stored in src/client/app/. This is the code that actually runs in the
            user&#39;s
            web browser. See the technologies page for a diagram showing how this code
            is
            transpiled and minified prior to delivery.
        This code is contained in several directories:
        
             actions/ are the messages that components send to reducers to change the application
                state. 
             components/ are the React.js components which generate HTML that is displayed on the
                page.
                Components can be combined and composed to create the UI that is displayed to the user. 
             containers/ connect the React.js components to the application state (managed by
                Redux)
                through props and dispatched actions. 
             reducers/ accept messages sent by components and change the global application state
                accordingly. 
             style/ CSS files for the website. 
             translations/ defines the strings used to make OED multilingual. 
             types/ define the datatypes used throughout the frontend. 
             utils/ defines functions used across the application and some APIs. 
        

        Backend Code
        All backend code is stored in src/server/, except for the executable server, which is
            src/bin/www/.
        
        Beneath that, there are several folders:
        
             data/ functions to generate test data (not used directly by the application but for
                testing). 
             middleware/ middleware for dealing with web requests. 
             migrations/ contains SQL files that are used to upgrade between database versions.
            
             models/ contains classes which connect JavaScript code to the database so that routes
                can
                actually interact with data. 
             routes/ contains functions defining the actual URLs that the server provides, which is
                how
                the frontend interacts with the server. 
             services/ contains scripts used by developers and administrators to modify the data in
                ways that are inaccessible through the web interface. 
             sql/ contains the database queries used by models to talk to the PostgreSQL database.
            
             test/ contains the test code run for validation of OED. 
             utils/ contains utility functions and constants. 
        

        Common Code
        All common code is stored in src/common/. This code defines data types which are in shared use
            between the client and the server.

        Scripts
        Scripts are stored in src/scripts/.
        The scripts are as follows:
        
             checkHeader.sh verifies that all source files have the MPLv2 legal header. It is run
                in
                CI. 
             checkMeters.sh verifies if a file of IP addresses has meters that respond. Used for
                testing meters or before input of meters into OED. Mostly targets MAMAC meters that are web based. 
             checkTypescript.sh verifies that there are no untyped JavaScript files in the client
                tree.
                It is run in CI. 
             devcheck.sh runs all the checks (header, typescript, types and lint) in one easy step.
            
             devstart.sh starts both the webserver and Webpack, in dev mode (watches files and
                shows
                interactive). This isn not normally used to start OED for developers. 
             installOED.sh sets up OED, either for development or production, creating the database
                schema and installing dependencies. This is often run using docker compose up or some
                variant
                of this. It should be automatically run inside toe VSC container. 
             oed.service is a sample systemd unit file which allows Linux system administrators to start OED on
                startup.
            
             refreshReadingViewsCron.bash is a script meant to be run at regular intervals (for
                instance, with cron) which updates the daily view table that is needed to graph OED data. 
             refreshDailyReadingViewsCron.bash is a script meant to be run at regular intervals
                (for
                instance, with cron) which updates the hourly view table that is needed to graph OED data. 
             sendLogEmailCron.bash is a script meant to be run at regular intervals (for instance,
                with
                cron) which sends an email with information from OED logging since the last time this ran. 
             updateEgaugeMetersOEDCron.bash is a script meant to be run at regular intervals (for
                instance, with cron) which updates eGauge-brand meters. 
             updateMamacMetersOEDCron.bash is a script meant to be run at regular intervals (for
                instance, with cron) which updates Mamac-brand pull-type meters. 
             updateOED.sh To be run after pulling the latest version from Git. Grabs new
                dependencies
                and migrates the database. 
        
        Other directories
        One will see other directories in the OED code base after install and work with OED. These are not normally
            changed by someone. A few noticeable ones are:
        
        
            node_modules/ is created during the npm install process and contains information on all
                node packages used.
            postgres-data/ is created during the PostgreSQL install process and contains the
                information about the database and all records stored. It is the one set of files that exist between
                runs of
                the Docker container and are linked from the Docker container to the regular file system. This is done
                so
                that the database settings and records exist between runs.">
	<meta property="og:url" content="https://huss.github.io/OpenEnergyDashboard.github.io/developer/codeOrganization/">
	<meta property="og:locale" content="en_EN">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="Open Energy Dashboard">
	
	


	

	<link type="text/plain" rel="author" href="https://huss.github.io/OpenEnergyDashboard.github.io/humans.txt">

	

	

	<link rel="icon" sizes="32x32" href="https://huss.github.io/OpenEnergyDashboard.github.io/assets/img/OEDIcon22x32.png">

	<link rel="icon" sizes="192x192" href="https://huss.github.io/OpenEnergyDashboard.github.io/assets/img/OEDIcon192x274.png">

	

	

	

	

	

	

	

	

	

	


	

	


</head>
<body id="top-of-page" class="page-fullwidth">
	
	
<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar data-options="scrolltop: false">
    <ul class="title-area">
      <li class="name">
      <!-- Add / at end of href to avoid redirect. -->
      <h1 class="hide-for-large-up"><a href="https://huss.github.io/OpenEnergyDashboard.github.io/" class="icon-tree"> Open Energy Dashboard</a></h1>
    </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar toggle-topbar-click menu-icon"><a><span>Nav</span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="left">
        

              

          
          

            
            
              <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/">home</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a  href="https://huss.github.io/OpenEnergyDashboard.github.io/features/">features</a>

                  <ul class="dropdown">
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/features/">features by type</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/useAcademic/">features by academic use</a></li>
                    
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a  href="https://huss.github.io/OpenEnergyDashboard.github.io/helpV1.0.0/user/">Documentation</a>

                  <ul class="dropdown">
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/helpV1.0.0/user/">oed version 1.0.0</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/helpV0.8.0/index/">oed version 0.8.0</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/helpV0.7.0/index/">oed version 0.7.0</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/helpV0.6.0/index/">oed version 0.6.0</a></li>
                    
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          

            
            
              <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/use/">Adopting</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a  href="https://huss.github.io/OpenEnergyDashboard.github.io/news/">info</a>

                  <ul class="dropdown">
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/news/">news</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/principles/">project principles</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/free/">free &amp; maintained</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/mission/">mission</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/why/">why exists</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/projectInfo/">project information pages &amp; license</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/name/">why OED name, logo &amp; some history</a></li>
                    
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        
        
      </ul>
      
      

      <ul class="right">
        

              



          
          
        

              



          
          
        

              



          
          
        

              



          
          
        

              



          
          
        

              



          
          
            
            
              <li class="divider"></li>
              <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/search/">Search</a></li>

            
            
          
        

              



          
          
            
            
              <li class="divider"></li>
              <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/contact/">Contact</a></li>

            
            
          
        

              



          
          
            
            
              <li class="divider"></li>
              <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/developer/">developer docs</a></li>

            
            
          
        

              



          
          
            
            

              <li class="divider"></li>
              <li class="has-dropdown">
                <a  href="https://huss.github.io/OpenEnergyDashboard.github.io/involved/">get involved</a>

                  <ul class="dropdown">
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/internship/">becoming a developer</a></li>
                    

                      

                      <li><a  href="https://huss.github.io/OpenEnergyDashboard.github.io/studentExperience/">student experience</a></li>
                    
                  </ul>

              </li>
            
          
        
        
      </ul>
     
    </section>
  </nav>
</div><!-- /#navigation -->

	

	<!-- The image at the top varies if regular page or a documentation page. -->




<div id="masthead-no-image-header">
	<div class="row">
		<div class="small-12 columns">
			<a id="logo" href="https://huss.github.io/OpenEnergyDashboard.github.io/" title="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard">
				<img src="https://huss.github.io/OpenEnergyDashboard.github.io/assets/img/logoDeveloper.png" alt="Open Energy Dashboard – A Free, Open Source Energy/Resource Dashboard">
			</a>
		</div><!-- /.small-12.columns -->
	</div><!-- /.row -->
</div><!-- /#masthead -->




<nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs">
  <!-- Added / at end of URL to avoid redirect. -->
 <a href="https://huss.github.io/OpenEnergyDashboard.github.io/">Start</a>
 
   
    
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/">developer</a>
    
  
    
        <a class="current">Code Organization</a>
    
  
</nav>









	


<div class="row t30">
	<div class="medium-12 columns">
		<article>
			<header>
				<p class="subheadline">OED Developer Documentation</p>
				<h1>Code Organization</h1>
			</header>

			

			<div class="row">
    





<div class="medium-4 medium-push-8 columns" markdown="1">
    <div class="panel radius" markdown="1">
        <div style="list-style: none;" class="side-nav">
            <!-- Add header since not done elsewhere. -->
            
            <h4><a href='../developer/'>Documentation overview</a></h4>

            








<div>
    

    

    
        
        <h5>Developer documentation</h5>
        







<div style="padding-left: 1em;">
  <h6>Information</h6>
  <div style="padding-left: 1em;">
    <!-- TODO check that this actually is looping as desired across collections. -->
    <!-- Cannot nest if with for so do for every page but ignored if not a link to show. 
          This adds a description if it is the documentation page (vs documentation sidebar).
          It will be an empty string if not a documentation page true.
          Comment for first part of for but here so not repeated many times in _site files. -->
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/developer/">Overview</a></br>
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
  </div>
</div>

        







<div style="padding-left: 1em;">
  <h6>Starting</h6>
  <div style="padding-left: 1em;">
    <!-- TODO check that this actually is looping as desired across collections. -->
    <!-- Cannot nest if with for so do for every page but ignored if not a link to show. 
          This adds a description if it is the documentation page (vs documentation sidebar).
          It will be an empty string if not a documentation page true.
          Comment for first part of for but here so not repeated many times in _site files. -->
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/gettingStarted/">Developer First Steps</a></br>
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/wslSteps/">Steps for WSL</a></br>
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/cla/">Contributor License Agreement</a></br>
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/pr/">Creating Pull Requests</a></br>
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/testData/">Test Data</a></br>
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/work/">Work Selection</a></br>
      
    
  </div>
</div>

        







<div style="padding-left: 1em;">
  <h6>Codebase Info</h6>
  <div style="padding-left: 1em;">
    <!-- TODO check that this actually is looping as desired across collections. -->
    <!-- Cannot nest if with for so do for every page but ignored if not a link to show. 
          This adds a description if it is the documentation page (vs documentation sidebar).
          It will be an empty string if not a documentation page true.
          Comment for first part of for but here so not repeated many times in _site files. -->
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/learningTechnologies/">Learn OED Technology</a></br>
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/npm/">npm scripts</a></br>
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/technologies/">Technology Overview</a></br>
      
    
      
      
    
      
      
    
      
      
    
  </div>
</div>

        







<div style="padding-left: 1em;">
  <h6>Further Details</h6>
  <div style="padding-left: 1em;">
    <!-- TODO check that this actually is looping as desired across collections. -->
    <!-- Cannot nest if with for so do for every page but ignored if not a link to show. 
          This adds a description if it is the documentation page (vs documentation sidebar).
          It will be an empty string if not a documentation page true.
          Comment for first part of for but here so not repeated many times in _site files. -->
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/codeGuidelines/">Documentation Expectations</a></br>
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/codeOrganization/">Code Organization</a></br>
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/devDetails/">Developer Details</a></br>
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/environment/">Environment Variables</a></br>
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/fullInstallOutput/">Full Install Output</a></br>
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/noNPMInstallOutput/">No npm/DB Install Output</a></br>
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/testing/">Test Code</a></br>
      
    
      
      
    
  </div>
</div>

        







<div style="padding-left: 1em;">
  <h6>Version Release</h6>
  <div style="padding-left: 1em;">
    <!-- TODO check that this actually is looping as desired across collections. -->
    <!-- Cannot nest if with for so do for every page but ignored if not a link to show. 
          This adds a description if it is the documentation page (vs documentation sidebar).
          It will be an empty string if not a documentation page true.
          Comment for first part of for but here so not repeated many times in _site files. -->
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
        <a href="https://huss.github.io/OpenEnergyDashboard.github.io/developer/release/">Releasing OED</a></br>
      
    
      
      
    
      
      
    
      
      
    
      
      
    
  </div>
</div>

    

    

    
</div>

        </div>
    </div>
</div>

    <div class="medium-8 medium-pull-4 columns" markdown="1">
        


<div class="alert-box info "><p>This information is for developers of the OED software so this information is not usually of interest to a general user.</p>
</div>






<div class="alert-box warning "><p>The update to the Redux Toolkit (RTK) is not yet reflected in the documentation. As a result, some information may be out of date.</p>
</div>




        <p>The OED code base is organized into directories. Understanding the structure of this layout can help in
            working
            on the code.</p>

        <p>The project is organized into a number of subdirectories. The primary division is among:</p>
        <ul>
            <li>Metadata, configs, and deployment information</li>
            <li>Frontend code</li>
            <li>Backend code</li>
            <li>Common code</li>
            <li>Other directories</li>
        </ul>

        <h2>Metadata</h2>
        <p>In the root directory, OED has several metadata files. These are further organized by technology or purpose.
        </p>
        <h3>For Humans</h3>
        <ul>
            <li><strong>CODE_OF_CONDUCT</strong> describes conduct expectations and how to report any concerns.</li>
            <li> <strong>CONTRIBUTING.md</strong> provides information on contributing to OED. </li>
            <li> <strong>License.txt</strong> describes the legal aspect of the project. OED is licensed under the <a
                    href="https://www.mozilla.org/en-US/MPL/2.0/" rel="nofollow">Mozilla Public License version 2.0</a>.
            </li>
            <li> <strong>README.md</strong> is an overview of the project, displayed on the GitHub front page for the
                project. </li>
            <li><strong>Security.md</strong> describes how to report security concerns to OED.</li>
            <li><strong>Support.md</strong> describes where to get information on support related to OED.</li>
            <li> <strong>USAGE.md</strong> describes how to install, configure, and use the project from a sysadmin's
                point
                of view. </li>
        </ul>
        <h3>For Development Tools</h3>
        <ul>
            <li><strong>.devcontainer/</strong> has files to set up the Visual Studio Code container.</li>
            <li><strong>.github/</strong> ISSUE_TEMPLATE/ has GitHub issue template, workflows/ has two .yml files for
                GitHub Actions: one for CI and one for static and dependabot.yml controls GitHub automated pull
                requests.
            <li><strong>.vscode/</strong> contains (currently nonworking) instructions to run OED within Visual Studio
                Code.
            </li>
            <li><strong>.dockerignore</strong> defines files that Docker ignores.</li>
            <li> <strong>.editorconfig</strong> conveys some of our basic style rules to most common code editors. </li>
            <li><strong>.eslintignore</strong> defines files to include in ESLint checking.</li>
            <li><strong>.eslintrc.json</strong> defines the ESLint rules</li>
            <li> <strong>.gitattributes</strong> informs Git about how to properly show diffs for our files. </li>
            <li> <strong>.gitignore</strong> informs the Git Version Control System about files that it should not
                track.
            </li>
            <li><strong>client.js</strong> does database setup for GitHub Action CI.</li>
            <li> <strong>tslint.json</strong> configures the TSLint code quality tool and style checker </li>
        </ul>
        <h3>For Code Transformers</h3>
        <ul>
            <li> <strong>babel.config.json</strong> configures the Babel JavaScript compiler </li>
            <li> <strong>webpack.config.js</strong> configures the WebPack JavaScript uglifier, optimizer, and packer
            </li>
        </ul>
        <h3>For Dependency Management Tools</h3>
        <ul>
            <li><strong>.npmrc</strong> tells node package versions to allow on install</li>
            <li> <strong>docker-compose.yml</strong> specifies how to collect the database and web/vsc Docker containers
                together into a working deployment </li>
            <li>the <strong>containers/</strong> directory contains everything needed to build the Docker containers
                with
                subdirectories for the database and web (along with proxy if needed). </li>
            <li> <strong>.dockerignore</strong> tells the Docker containerization engine which files to ignore </li>
            <li> <strong>package.json</strong> specifies direct dependencies and some package metadata </li>
            <li> <strong>package-lock.json</strong> specifies working direct and transitive dependencies used on the
                last
                build committed </li>
        </ul>

        <h2>Frontend Code</h2>
        <p>All frontend code is stored in <code>src/client/app/</code>. This is the code that actually runs in the
            user's
            web browser. See the <a href="./technologies.html">technologies</a> page for a diagram showing how this code
            is
            transpiled and minified prior to delivery.</p>
        <p>This code is contained in several directories:</p>
        <ul>
            <li> <strong>actions/</strong> are the messages that components send to reducers to change the application
                state. </li>
            <li> <strong>components/</strong> are the React.js components which generate HTML that is displayed on the
                page.
                Components can be combined and composed to create the UI that is displayed to the user. </li>
            <li> <strong>containers/</strong> connect the React.js components to the application state (managed by
                Redux)
                through props and dispatched actions. </li>
            <li> <strong>reducers/</strong> accept messages sent by components and change the global application state
                accordingly. </li>
            <li> <strong>style/</strong> CSS files for the website. </li>
            <li> <strong>translations/</strong> defines the strings used to make OED multilingual. </li>
            <li> <strong>types/</strong> define the datatypes used throughout the frontend. </li>
            <li> <strong>utils/</strong> defines functions used across the application and some APIs. </li>
        </ul>

        <h2>Backend Code</h2>
        <p>All backend code is stored in <code>src/server/</code>, except for the executable server, which is
            <code>src/bin/www/</code>.
        </p>
        <p>Beneath that, there are several folders:</p>
        <ul>
            <li> <strong>data/</strong> functions to generate test data (not used directly by the application but for
                testing). </li>
            <li> <strong>middleware/</strong> middleware for dealing with web requests. </li>
            <li> <strong>migrations/</strong> contains SQL files that are used to upgrade between database versions.
            </li>
            <li> <strong>models/</strong> contains classes which connect JavaScript code to the database so that routes
                can
                actually interact with data. </li>
            <li> <strong>routes/</strong> contains functions defining the actual URLs that the server provides, which is
                how
                the frontend interacts with the server. </li>
            <li> <strong>services/</strong> contains scripts used by developers and administrators to modify the data in
                ways that are inaccessible through the web interface. </li>
            <li> <strong>sql/</strong> contains the database queries used by models to talk to the PostgreSQL database.
            </li>
            <li> <strong>test/</strong> contains the test code run for validation of OED. </li>
            <li> <strong>utils/</strong> contains utility functions and constants. </li>
        </ul>

        <h2>Common Code</h2>
        <p>All common code is stored in <code>src/common/</code>. This code defines data types which are in shared use
            between the client and the server.</p>

        <h2>Scripts</h2>
        <p>Scripts are stored in <code>src/scripts/</code>.</p>
        <p>The scripts are as follows:</p>
        <ul>
            <li> <strong>checkHeader.sh</strong> verifies that all source files have the MPLv2 legal header. It is run
                in
                CI. </li>
            <li> <strong>checkMeters.sh</strong> verifies if a file of IP addresses has meters that respond. Used for
                testing meters or before input of meters into OED. Mostly targets MAMAC meters that are web based. </li>
            <li> <strong>checkTypescript.sh</strong> verifies that there are no untyped JavaScript files in the client
                tree.
                It is run in CI. </li>
            <li> <strong>devcheck.sh</strong> runs all the checks (header, typescript, types and lint) in one easy step.
            </li>
            <li> <strong>devstart.sh</strong> starts both the webserver and Webpack, in dev mode (watches files and
                shows
                interactive). This isn not normally used to start OED for developers. </li>
            <li> <strong>installOED.sh</strong> sets up OED, either for development or production, creating the database
                schema and installing dependencies. This is often run using <code>docker compose up</code> or some
                variant
                of this. It should be automatically run inside toe VSC container. </li>
            <li> <strong>oed.service</strong> is a sample <a href="https://www.freedesktop.org/wiki/Software/systemd/"
                    rel="nofollow">systemd</a> unit file which allows Linux system administrators to start OED on
                startup.
            </li>
            <li> <strong>refreshReadingViewsCron.bash</strong> is a script meant to be run at regular intervals (for
                instance, with cron) which updates the daily view table that is needed to graph OED data. </li>
            <li> <strong>refreshDailyReadingViewsCron.bash</strong> is a script meant to be run at regular intervals
                (for
                instance, with cron) which updates the hourly view table that is needed to graph OED data. </li>
            <li> <strong>sendLogEmailCron.bash</strong> is a script meant to be run at regular intervals (for instance,
                with
                cron) which sends an email with information from OED logging since the last time this ran. </li>
            <li> <strong>updateEgaugeMetersOEDCron.bash</strong> is a script meant to be run at regular intervals (for
                instance, with cron) which updates eGauge-brand meters. </li>
            <li> <strong>updateMamacMetersOEDCron.bash</strong> is a script meant to be run at regular intervals (for
                instance, with cron) which updates Mamac-brand pull-type meters. </li>
            <li> <strong>updateOED.sh</strong> To be run after pulling the latest version from Git. Grabs new
                dependencies
                and migrates the database. </li>
        </ul>
        <h2>Other directories</h2>
        <p>One will see other directories in the OED code base after install and work with OED. These are not normally
            changed by someone. A few noticeable ones are:
        </p>
        <ul>
            <li><strong>node_modules/</strong> is created during the npm install process and contains information on all
                node packages used.</li>
            <li><strong>postgres-data/</strong> is created during the PostgreSQL install process and contains the
                information about the database and all records stored. It is the one set of files that exist between
                runs of
                the Docker container and are linked from the Docker container to the regular file system. This is done
                so
                that the database settings and records exist between runs.</li>
        </ul>
    </div>
</div>

		</article>
	</div><!-- /.medium-12.columns -->
</div><!-- /.row -->




	
	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" href="#top-of-page">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->


    <footer id="footer-content" class="bg-grau">
      <div id="footer">
        <div class="row">
          <div class="medium-6 large-5 columns">
            <h5 class="shadow-black">About This Site</h5>

            <p class="shadow-black">
              The OED dashboard allows organization to acquire, archive, analyze and display energy/resource usage.
              <a href="https://huss.github.io/OpenEnergyDashboard.github.io/features/">More ›</a>
            </p>
          </div><!-- /.large-6.columns -->


          <div class="small-6 medium-3 large-3 large-offset-1 columns">
            
              
                <h5 class="shadow-black">Services</h5>
              
            
              
            
              
            

              <ul class="no-bullet shadow-black">
              
              <!-- Add / at end of capture string to avoid redirect issue. -->
                
                  <li >
                    <a href="https://huss.github.io/OpenEnergyDashboard.github.io/"  title=""></a>
                  </li>
              
              <!-- Add / at end of capture string to avoid redirect issue. -->
                
                  <li >
                    <a href="https://huss.github.io/OpenEnergyDashboard.github.io//contact/"  title="Contact">Contact</a>
                  </li>
              
              <!-- Add / at end of capture string to avoid redirect issue. -->
                
                  <li >
                    <a href="https://huss.github.io/OpenEnergyDashboard.github.io//sitemap.xml"  title="Sitemap for Google Webmaster Tools">sitemap.xml</a>
                  </li>
              
              </ul>
          </div><!-- /.large-4.columns -->


          <div class="small-6 medium-3 large-3 columns">
            

            <ul class="no-bullet shadow-black">
            
            </ul>
          </div><!-- /.large-3.columns -->
        </div><!-- /.row -->

      </div><!-- /#footer -->


      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-12 medium-6 columns credits">
            <p>Created by the OED team using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> based on <a href="https://phlow.github.io/feeling-responsive/">Feeling Responsive</a>. This page is part of the Open Energy Dashboard and is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, you can obtain one at <a href="https://www.mozilla.org/en-US/MPL/2.0/" rel="nofollow">https://www.mozilla.org/en-US/MPL/2.0/</a>.</p>
          </section>

          <section id="subfooter-right" class="small-12 medium-6 columns">
            <ul class="inline-list social-icons">
            
              <li><a href="https://github.com/OpenEnergyDashboard/OED" target="_blank" class="icon-github" title="Code other repos..."></a></li>
            
            </ul>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>

	

	


<script src="https://huss.github.io/OpenEnergyDashboard.github.io/assets/js/javascript.min.js"></script>












</body>
</html>

